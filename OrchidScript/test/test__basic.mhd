/* Check basic functions, 
 * like assert and typeof. */
assert(true);
assert(typeof(true)   == 'bool');
assert(typeof(false)  == 'bool');
assert(typeof(1)      == 'int');
assert(typeof(1.0)    == 'double');
assert(typeof([](){}) == 'function');
/* Check type casts. */
assert(typeof(+true) == 'int' );
assert(typeof(~true) == 'int' );
assert(typeof(!true) == 'bool');    
assert(typeof(true + true) == 'int' );
assert(typeof(1 + true) == 'int' );
assert(typeof(true + 1) == 'int' );
/* Test arrays. */
let a = 1;
let b = 1;
print(a);
b[1] = a;
a[1] = a;
// Test comment.
print(a);
print(b);
/* Test conditional statements. */
if (1) {} else {assert(false);}
if (0) {assert(false);} else {}
/* Check try-catch. */
try {
    throw 'a bone';
} catch (what) {
    print('caught');
    assert(what == 'a bone');
}
/* Test operators overloading. */
a = make_map();
a.destruct = [](this) {
    print("dtor");
};
a.operator{+} = [](this) {
    print("overloaded operator{+}");
};
a.operator/ = [](this, other) {
    print("overloaded operator/");
    123;
};
function a.operator+(this, other) {
    print("overloaded operator+");
    456;
};
+a;
print(a + a);
print(a / a);
a = {};
/* Test foreigns. */
function fopen(file, mode)
{
	return foreign('void* fopen(char*, char*)', '', file, mode);
}
function fputs(file, line)
{
	return foreign('int fputs(void*, char*)', '', file, line);
}

//foreign('int add(int, int)', '', 1, 10);
//foreign('int puts(char*)', '', 'Hui!');
f = foreign('void* fopen(char*, char*)', '', 'a.out', 'r');
print(f);
f = foreign('void* fopen(char*, char*)', '', 'a.aut', 'r');
print(f);
//foreign('int fputs(char*, void*)', '', "123", f);
//1;
//f = fopen('1.out', 'w');
//fputs(f, 'hello!');
/* Test classes. */
/*
class B {
    new(this, x) {
        this.x = x;
        this;
    }
    function f(this, y) {
        this.x + y;
    }
}
b = new B(12);
print(b.f(34), 46);
class A : B {
    function f(this, y) {
        return -this.base.f(y)
    }
}
function A.g(_, y, z) {
    y / z;
}
a = new A(12);
print(a.f(34), -46);
print(A.g(4, 2), 2);
*/

namespace std {
	/**
	 * Open a file.
	 * @param path Path to file.
	 * @param mode Opening mode.
	 */
	function fopen(path, mode) {
		assert(typeof(path) == 'string'));
		assert(typeof(mode) == 'string'));
		return foreign('void* fopen(char*, char*)', '', path, mode);
	}
	/**
	 * Close an opened file.
	 * @param file File to close.
	 */
	function fclose(file) {
		assert(typeof(file) == 'void*');
		return foreign('int fclose(void*)', '', file);
	}
	let file = class();
	function file.new(this, path, mode) {
		this.handle_ = stdbase.fopen(path, mode);
		this;
	}
	function file.puts(this, line) {
		stdbase.
	}
}




















